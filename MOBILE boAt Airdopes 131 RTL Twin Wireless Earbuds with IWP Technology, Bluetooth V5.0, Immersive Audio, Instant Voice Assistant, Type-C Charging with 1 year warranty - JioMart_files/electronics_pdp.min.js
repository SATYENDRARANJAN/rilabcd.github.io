function getAddonTotal(){var total_amount=parseInt(0);$(".ext_warranty_sku:checked").length>0&&(total_amount+=parseFloat($(".ext_warranty_sku:checked").attr("data-price"))),$(".add_on_sku:checked").each((function(){total_amount+=parseFloat($(this).attr("data-price"))})),total_amount=total_amount.toFixed(2),$("#add_on_total_amount").html("&#8377;"+total_amount)}function SimStatus5g(checked=!1){let mcat_dsfStatus=!1,dsf_status=!1;$("#doorstep_finance").length>0&&(mcat_dsfStatus=$("#doorstep_finance").val()),mcat_dsfStatus&&($(".doorstep-text").length,null!=$(".doorstep-text").attr("data-dsf_status")&&(dsf_status=$(".doorstep-text").attr("data-dsf_status"))),1==checked?$(".cart-action").hide():$(".cart-action").show();let sku=$("#product_id").val(),obj={sim_needed:checked,dsf_needed:JSON.parse(dsf_status)},obj_str='{"'+sku+'":'+JSON.stringify(obj)+"}";localStorage.setItem("5g_phone_info",obj_str)}function doorstepFinanceEligibility(prod_price=0){let userid=localStorage.getItem("userid"),authtoken=localStorage.getItem("authtoken"),selling_price=parseFloat(prod_price);if($("#avail_doorstep_finance").show(),authtoken&&userid&&"0"!=userid)$.ajax({url:"/hcat/rest/v1/5g/checkeligible",headers:{userid:userid,authtoken:authtoken},method:"POST",dataType:"JSON",async:!0,contentType:"application/json",data:JSON.stringify({amount:selling_price}),success:function(resp){if(resp.status)if("fail"==resp.status&&"01"==resp.errCode){let dsf_today=new Date;if(dsf_today.setMonth(dsf_today.getMonth()+3),localStorage.setItem("dsf_eligibility",dsf_today),$(".avail_dsf_status").hide(),$(".avail_dsf_check").show(),$(".doorstep-text").attr("data-dsf_status",!1),$("#5g_sim_required").length>0){let checked;SimStatus5g($("#5g_sim_required").prop("checked"))}}else if("success"==resp.status){let checked,sku,obj={sim_needed:$("#5g_sim_required").prop("checked"),dsf_needed:!0},obj_str='{"'+window.product_code+'":'+JSON.stringify(obj)+"}";localStorage.setItem("5g_phone_info",obj_str),$(".avail_dsf_status").hide(),$(".avail_dsf_success").show(),$(".doorstep-text").attr("data-dsf_status",!0);let debit_emi_offers_html='<div class="jm-list jm-ph-none" id="debit_card_emi">\n                            <div class="jm-list-prefix">\n                                <div class="jm-list-prefix-icon">\n                                    <img class="icon jm-mr-xs" src="/assets/ds2msite/jds-icons/debit-card-icon.svg" />\n                                </div>\n                            </div>\n        \n                            <div class="jm-list-content">\n                                <div class="jm-list-content-caption">\n                                    <div class="jm-list-content-caption-text jm-body-xxs-bold">\n                                        Avail EMI on Debit Card\n                                    </div>\n                                </div>\n        \n                                <div class="jm-list-content-title">\n                                    <div class="jm-list-content-title-text jm-body-xxs jm-fc-primary-grey-80">\n                                        Congratulations! You’re Pre-Approved for Debit Card EMI\n                                    </div>\n                                </div>\n                            </div>\n        \n                            <div class="jm-list-suffix jm-list-gap">\n                                <div class="jm-btn tertiary small jm-icon">\n                                    <img src="/assets/ds2msite/jds-icons/chevron-right-icon.svg" />\n                                </div>\n                            </div>\n                        </div>';$("#debit_emi_content").html(debit_emi_offers_html)}},error:function(){if($("#5g_sim_required").length>0){let checked;SimStatus5g($("#5g_sim_required").prop("checked"))}$(".avail_dsf_status").hide(),$(".avail_dsf_check").show(),$(".doorstep-text").attr("data-dsf_status",!1)}});else{if($("#5g_sim_required").length>0){let checked;SimStatus5g($("#5g_sim_required").prop("checked"))}$(".avail_dsf_status").hide(),$(".avail_dsf_check").show(),$(".doorstep-text").attr("data-dsf_status",!1)}}function check_is_valid_url(urlString){let urlPattern;return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(urlString)}function get_ds2_emi_html(emi_plans,source){let emi_html=`<ul class="nav jm-tab jm-body-xs" id="jmTab_${source}" role="tablist">`;return emi_html+=Object.keys(emi_plans).map((plan,i)=>{let plan_name=plan.replace("_"," ");return`<li class="jm-tab-item">\n                <a class="jm-tab-item-link ${0==i?"active":""}" id="${plan}" data-toggle="tab" href="#${source}_${plan}_tab">${plan_name}</a>\n            </li>`}).join(""),emi_html+=`</ul>\n    <div class="tab-content jm-tab-content jm-ph-base" id="jmTabContent_${source}">`,Object.keys(emi_plans).map((plan_name,i)=>{emi_html+=`<div class="tab-pane fade ${0==i?"active show":""}" id="${source}_${plan_name}_tab">\n        <div class="jm-body-xxs jm-fc-primary-grey-80 jm-pv-base"></div>\n        <div>`,Object.entries(emi_plans[plan_name]).map((emi,k)=>{let bank_name=emi[0],plans=emi[1],bank_image="";emi_html+=`<div class="accordion bank-list">\n                <div class="accordion-wrapper">\n                    <div class="accordion-outer jm-list jm-pt-xs jm-pb-xs jm-pl-none collapsed"\n                        data-toggle="collapse" data-target="#${source}_${plan_name}_${k}">\n\n                        <div class="jm-list-prefix">\n                            <div class="jm-list-prefix-icon">\n                                <img class="jm-mr-xs" src="" />\n                            </div>\n                        </div>\n\n                        <div class="jm-list-content">\n                            <div class="jm-list-content-title jm-body-s">\n                                ${bank_name}\n                            </div>\n                        </div>\n\n                        <div class="jm-list-suffix">\n                            <button class="jm-btn tertiary small jm-icon">\n                                <img class="collapse-toggle"\n                                    src="/assets/ds2msite/jds-icons/chevron-up-p60-m-icon.svg" />\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="accordion-inner jm-pb-base jm-body-xxs collapse" id="${source}_${plan_name}_${k}">\n                    <table class="bank-emi-table">\n                        <thead>\n                            <tr>\n                                <th>Months</th>\n                                <th>EMI Amount</th>\n                                <th>Interest</th>\n                                <th>Overall Cost</th>\n                            </tr>\n                        </thead>\n                        <tbody>`,emi_html+=plans.map(plan=>{let interest=plan.interest?plan.interest:plan.interest_percentage;return`<tr>\n                    <td>${plan.tenure}</td>\n                    <td>&#8377;${plan.emi_amount}</td>\n                    <td>${interest}%</td>\n                    <td>&#8377;${plan.total_amount}</td>\n                </tr>`}).join(""),emi_html+="</tbody>\n                    </table>\n                </div>\n            </div>"}),emi_html+=`<div class="jm-body-xs jm-mt-m ${source}_emi_disclaimer"></div>`,emi_html+="</div></div>"}),emi_html}function call_emi_api(source,phone_no){let alt_sku=$("#alt_sku").val(),price=window.selling_price,is_3p=0;$("body").hasClass("3p-prod-page")&&(is_3p=1);let myjio=0,url,attr=new Url(window.location.href).query.source_attribution;(attr&&"MyJio-CPS"==attr||"jio"==$.cookie("nms_refer_lite"))&&(myjio=1);let ajax_data={alt_sku:alt_sku,price:price,myjio:myjio,is_3p:is_3p,cat_id:emi_obj.cat_id,brand_id:emi_obj.brand_id};"credit"==source?(parent="emi_plans_dialog",emi_content="emi_dialog_content",ajax_url=domain_url+"catalog/emi/get"):(ajax_data.phone_no=phone_no,parent="debit_emi_popup",emi_content="debit_emi_popup_content",ajax_url=domain_url+"catalog/emi/get_debit"),$.ajax({url:ajax_url,type:"GET",data:ajax_data,dataType:"JSON",success:function(resp){if("success"==resp.status){if(resp.low&&"credit"==source){let credit_emi_html=`<div class="jm-list jm-ph-none" id="credit_emi_btn">\n                        <div class="jm-list-prefix">\n                            <div class="jm-list-prefix-icon">\n                                <img class="icon jm-mr-xs" src="/assets/ds2msite/jds-icons/credit-card-icon.svg" />\n                            </div>\n                        </div>\n                        <div class="jm-list-content">\n                            <div class="jm-list-content-caption">\n                                <div class="jm-list-content-caption-text jm-body-xxs-bold">\n                                    Avail EMI on Credit Card\n                                </div>\n                            </div>\n                            <div class="jm-list-content-title">\n                                <div class="jm-list-content-title-text jm-body-xxs jm-fc-primary-grey-80">\n                                    EMIs from ₹${resp.low}/month\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class="jm-list-suffix jm-list-gap">\n                            <div class="jm-btn tertiary small jm-icon">\n                                <img src="/assets/ds2msite/jds-icons/chevron-right-icon.svg" />\n                            </div>\n                        </div>\n                    </div>`;$("#credit_emi_content").html(credit_emi_html),$("#emi_btn_content").show()}if(resp.plans){let plans=resp.plans,plan_html=get_ds2_emi_html(plans,source);$("#"+emi_content).html(plan_html),(plans.hasOwnProperty("Low_Cost_EMI")||plans.hasOwnProperty("No_Cost_EMI"))&&$("."+source+"_emi_disclaimer").html('<span class="jm-body-xs-bold">Note: </span><span class="jm-fc-primary-grey-80">No-Cost/Low-Cost EMI or Cashback Schemes can be availed if the eligible products are the ONLY item in your cart. Please purchase additional items in a separate transaction.</span><div><a class="jm-link jm-mt-xxs" href="/emi-terms-and-conditions" target="_blank">T&C Apply</a></div>')}if("credit"==source&&resp.jioonepay_offers&&resp.jioonepay_offers.length>0){let jio_offers=`<div class="jm-list jm-ph-none CX-seemore">\n                        <div class="jm-list-prefix">\n                            <div class="jm-list-prefix-icon">\n                                <img class="icon jm-mr-xs" src="/assets/ds2msite/jds-icons/offer-icon.svg" />\n                            </div>\n                        </div>\n\n                        <div class="jm-list-content">\n                            <div class="jm-list-content-caption">\n                                <div class="jm-list-content-caption-text jm-body-xxs-bold">\n                                    EMI Offers\n                                </div>\n                            </div>\n\n                            <div class="jm-list-content-title">\n                                <div class="jm-list-content-title-text jm-body-xxs jm-fc-primary-grey-80">\n                                    ${resp.jioonepay_offers[0].offerDesc}\n                                </div>\n                            </div>\n\n                            <div class="jm-list-content-helper jm-body-xxs jm-fc-primary-grey-60">\n                                ${resp.jioonepay_offers.length} Offers Available\n                            </div>\n                        </div>\n\n                        <div class="jm-list-suffix jm-list-gap">\n                            <div class="jm-btn tertiary small jm-icon">\n                                <img src="/assets/ds2msite/jds-icons/chevron-right-icon.svg" />\n                            </div>\n                        </div>\n                    </div>`;$("#CX-offers").append(jio_offers);let count=$(".CX-title span").attr("data-count"),new_count=parseInt(count)+resp.jioonepay_offers.length;$(".CX-title span").text(`(${new_count})`).attr("data-count",new_count),$(".avail-header span").text(`(${new_count})`).attr("data-count",new_count);let emi_popup_offer_html,jio_popup_offer=`<div class="product-offer-item jm-ph-m jm-pt-base jm-pb-m">\n                        <div class="jm-list jm-ph-none jm-pv-xs border-default">\n                            <div class="jm-list-prefix jm-mr-xs jm-as-baseline">\n                                <div class="jm-list-prefix-icon">\n                                    <img src="/assets/ds2msite/jds-icons/additional-offer-panel-mobile-icon.svg" alt="" />\n                                </div>\n                            </div>\n\n                            <div class="jm-list-content jm-mb-xs">\n                                <div class="jm-list-content-caption">\n                                    <div class="jm-list-content-caption-text jm-body-xs-bold">\n                                        EMI Offer\n                                    </div>\n                                </div>\n\n                                <div class="jm-list-content-title jm-mb-xs">\n                                    <div class="jm-list-content-title-text jm-body-xxs jm-fc-primary-grey-80">\n                                        Get more offers on EMI\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        ${resp.jioonepay_offers.map((offer,ind)=>`\n                            <div class="accordian jm-cursor-pointer">\n                                <div class="accordian-wrapper">\n                                    <div class="accordian-outer jm-list jm-ph-none jm-pv-xxs jm-toggle-btn-animation collapsed"\n                                        data-toggle="collapse" data-target="#limitedOfferDeal-${ind}" aria-expanded="false"\n                                        aria-controls="limitedOfferDeal-${ind}">\n                                        <div class="jm-list-content">\n                                            <div class="jm-list-content-caption">\n                                                <div class="jm-list-content-caption-title jm-body-xxs-bold">\n                                                    ${offer.offerDesc}\n                                                </div>\n                                            </div>\n                                        </div>\n                                        ${offer.offerTnC&&check_is_valid_url(offer.offerTnC)?'<div class="jm-list-suffix">\n                                            <div class="jm-btn tertiary small jm-icon">\n                                                <img class="collapse-toggle" src="/assets/ds2msite/jds-icons/chevron-up-p60-m-icon.svg" alt="" />\n                                            </div>\n                                        </div>':""}\n                                    </div>\n                                </div>\n                                ${offer.offerTnC&&check_is_valid_url(offer.offerTnC)?`<div id="limitedOfferDeal-${ind}" class="accordian-inner product-features collapse">\n\n                                    <a href="${offer.offerTnC}" target="_blank" class="external_link">\n                                        <div class="jm-body-xxs-link jm-fc-primary-60 jm-mt-s jm-cursor-pointer">\n                                            Read T&C\n                                        </div>\n                                    </a>\n                                </div>`:""}\n                            </div>`).join("")}\n                    </div>`;$("#offers_popup_content").append(jio_popup_offer)}}else"credit"==source&&$("#emi_btn_content").remove()},error:function(){"credit"==source&&$("#emi_btn_content").remove()}})}function get_debit_card_emi(){let phone_no="";if(localStorage.getItem("authtoken")&&"0"!=localStorage.getItem("userid")&&null!=localStorage.getItem("userid")){let authtoken=localStorage.getItem("authtoken"),userid=localStorage.getItem("userid"),mstar_url,get_user_api=$("#mstar_api_baseurl").val()+"entity/customer/get_details";$.ajax({url:get_user_api,data:{},headers:{userid:userid,authtoken:authtoken},method:"GET",dataType:"JSON",async:!1,success:function(resp){"success"==resp.status&&resp.result.your_details.mobile_no&&(phone_no=resp.result.your_details.mobile_no)},error:function(){}})}call_emi_api("debit",phone_no)}function close_dsf_popup(){$("body").removeClass("disable-scroll"),$("#doorstep_popup").removeClass("jm-bottomsheet-visible")}function close_debit_emi_popup(){$("body").removeClass("disable-scroll"),$("#debit_emi_popup").removeClass("jm-bottomsheet-visible")}function reset_addon_selection(){$("#elec_addon_dialog input[type='checkbox']").not(":disabled").each((function(){$(this).prop("checked",!1)})),$("#elec_addon_dialog input[type='radio']").not(":disabled").each((function(){$(this).prop("checked",!1)}))}$(document).ready((function(){if(null!=localStorage.getItem("buy_now_cart_info")&&null!=localStorage.getItem("buy_now_cart_info")&&""!=localStorage.getItem("buy_now_cart_info")&&localStorage.getItem("ChannelID")&&localStorage.removeItem("ChannelID"),null!=localStorage.getItem("dsf_eligibility")){let dsf_expiry=localStorage.getItem("dsf_eligibility"),dsf_today=new Date,dsf_expiry_date=new Date(dsf_expiry);if(dsf_today.getTime()<dsf_expiry_date.getTime()&&($(".avail_dsf_status").hide(),$(".avail_dsf_check").show(),$(".doorstep-text").attr("data-dsf_status",!1),$("#5g_sim_required").length>0)){let checked;SimStatus5g($("#5g_sim_required").prop("checked"))}}})),$(window).on("load",(function(){if($("#5g_sim_required").length>0){let checked;SimStatus5g($("#5g_sim_required").prop("checked"))}})),$("#elec_addon_dialog").on("shown.bs.modal",(function(){$(".ext_warranty_sku,.add_on_sku").each((function(){$(this).prop("checked",!1)})),getAddonTotal()})),$("#elec_addon_dialog").on("hidden.bs.modal",(function(){$(".buynowbtn").attr("data-source","")})),$(document).on("click",".add-on-skip",(function(){var source;"addtocart"==$("#elec_addon_dialog").attr("data-source")?($("body").removeClass("disable-scroll"),$("#elec_addon_dialog").removeClass("jm-bottomsheet-visible")):localStorage.getItem("buynowdata")?window.location.href="/customer/account/login":(get_cart_details(!1),window.location.href="/checkout/review")})),$(".ext_warranty_sku,.add_on_sku").change((function(){$(".ext_warranty_sku:checked").length>0||$(".add_on_sku:checked").length>0?($(".add-on-submit").prop("disabled",!1),$(".add-on-submit").removeClass("disabled")):($(".add-on-submit").prop("disabled",!0),$(".add-on-submit").addClass("disabled")),getAddonTotal()})),$(document).on("change","#5g_sim_required",(function(){let checked=$(this).prop("checked");void 0!==SimStatus5g&&SimStatus5g(checked)})),$(document).on("click","#debit_card_emi",(function(){$("#debit_emi_popup_content").hasClass("empty")&&(get_debit_card_emi(),$("#debit_emi_popup_content").removeClass("empty")),$("body").addClass("disable-scroll"),$("#debit_emi_popup").addClass("jm-bottomsheet-visible")})),$("#doorstep_finance_content").click((function(){$("body").addClass("disable-scroll"),$("#doorstep_popup").addClass("jm-bottomsheet-visible")}));