function isIOS(){return/iPad|iPhone|iPod/.test(window.navigator.userAgent)}function sendToApp(payload){const encodedData=window.btoa(JSON.stringify(payload));window.android&&window.android.__externalCall&&window.android.__externalCall(encodedData),window.__externalCall&&window.__externalCall(encodedData),this.isIOS()&&window.webkit.messageHandlers&&window.webkit.messageHandlers.callback&&window.webkit.messageHandlers.callback.postMessage(encodedData)}function back(){this.sendToApp({type:"close"})}function homeBack(){this.sendToApp({type:"close"})}function loadingComplete(){this.sendToApp({type:"loadingCompleted"})}function handleDeepLink(data){sendToApp({type:"handleDeeplink",value:data})}function myjio_updatecart(data){this.sendToApp({type:"updatedCartCount",value:{microAppID:"10002",itemsCount:parseInt(data)}})}function getSessionDetails(){sendToApp({type:"getSessionDetails",value:{microAppID:"10002"}})}function saveSessionDetails(data){sendToApp({type:"saveSessionDetails",value:{microAppID:"10002",details:data}})}function open_external_link(link){sendToApp({type:"launchbrowser",value:link})}function myjio_app_header(type){sendToApp({type:"presentHeader",value:parseInt(type)})}function myjio_show_header(){sendToApp({type:"showHeader"})}function myjio_hide_header(){sendToApp({type:"hideHeader"})}function myjio_send_email(to_email){sendToApp({type:"sendEmail",value:{subject:"",to:to_email,body:""}})}function myjio_make_call(mobile_number){sendToApp({type:"makeCall",value:mobile_number})}function myjio_search_endpoint(){var pincode=window.default_pin;localStorage.getItem("nms_mgo_pincode")&&(pincode=localStorage.getItem("nms_mgo_pincode"));var master_code=JSON.parse(localStorage.getItem("jio_region_codes")),region_filter="",cat_filter="",available_filter="",available_stores_arr=[];for(var vertical in master_code){var cat_name=vertical.toLowerCase();if(cat_name=cat_name.charAt(0).toUpperCase()+cat_name.slice(1),master_code[vertical]){if("1"==window.autocomplete_inventory)for(let k in master_code[vertical]){var code;available_filter+="available_stores:"+master_code[vertical][k]+" OR "}available_stores_arr.push(vertical.toLowerCase())}else cat_filter+="NOT category_level.level1:"+cat_name+" AND "}available_stores_arr.push("master_vertical"),""!=cat_filter&&(region_filter+="("+(cat_filter=cat_filter.slice(0,-5))+")"),""!=cat_filter&&""!=available_filter&&(region_filter+=" AND "),""!=available_filter&&(region_filter+="("+(available_filter=available_filter.slice(0,-4))+")"),sendToApp({type:"saveDetailsForSearchEndpoint",value:{pincode:pincode,regionCode:master_code,productVerticals:available_stores_arr,endpointDetails:{hitsPerPage:10,clickAnalytics:!0,filters:region_filter,analyticsTags:"MyJio-CPS"}}})}function setJioCookie(name,value,days){if(days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3);var expires="; expires="+date.toGMTString()}else var expires="";document.cookie=name+"="+value+expires+"; path=/"}function getJioCookie(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null}function deleteJioCookie(name){setJioCookie(name,"",-1)}function myjioValidate(src_attr_arr){src_attr_arr[1]&&"MyJio-CPS"==src_attr_arr[1]&&null==localStorage.getItem("authtoken")&&(getSessionDetails(),"undefined"!==window.storedSessionDetails?window.storedSessionDetails=storeddata=>{if(storeddata){var storedJson=JSON.parse(storeddata);storedJson.status&&"success"==storedJson.status&&storedJson.result.session?loginDetail(storedJson):ssoLoginDetail()}else ssoLoginDetail()}:ssoLoginDetail(),loadingComplete())}function myjioScrollPosition(value){this.sendToApp({type:"scrollPosition",value:value})}function app_bottom_availablity(data){this.sendToApp({type:"bottomBarVisibility",value:parseInt(data)})}function app_floater_availablity(data){this.sendToApp({type:"floaterVisibility",value:parseInt(data)})}var jioScrollTop=0;$(window).scroll((function(event){var url,attr=new Url(window.location.href).query.source_attribution;if(!$("body").hasClass("ios-deletion")&&(attr&&"MyJio-CPS"==attr||null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite"))){var st=$(this).scrollTop(),all_height;$(window).scrollTop()+window.innerHeight+100>=$(document).height()?myjioScrollPosition("1"):myjioScrollPosition(st>jioScrollTop?"1":"0"),jioScrollTop=st}}));var body=document.getElementsByTagName("body")[0];if(body.classList.contains("myjiostore")){var url=window.location,version=localStorage.getItem("jio_app_version"),os=localStorage.getItem("jio_app_os"),is_old_version=!0;if(os&&version){os=os.toLowerCase();var app_ios_version=document.getElementById("myjio_ios_version").value,app_android_version=document.getElementById("myjio_android_version").value;"ios"==os&&compareAppVersion(app_ios_version,version)&&(is_old_version=!1),"android"==os&&compareAppVersion(app_android_version,version)&&(is_old_version=!1)}0==is_old_version?body.classList.contains("cms-home")?(myjio_app_header(0),myjio_show_header()):(myjio_app_header(2),myjio_hide_header()):document.querySelector(".header-main").style.display="flex"}function showUnsupportedPin(){$("#unsupported_pincode").modal({backdrop:"static",keyboard:!1})}function do_sso_login(authtoken){var domain_url=window.location.origin+"/";localStorage.removeItem("jio_popup_pincode");let url=domain_url+"mst/rest/v1/myjio/authenticate_token?token="+authtoken;$.ajax({url:url,data:{},method:"GET",dataType:"JSON",success:function(resp){if("success"==resp.status)if(resp.result.session){saveSessionDetails(resp);let result=resp.result.session,expiredate=new Date(result.valid_till);if(localStorage.setItem("authtoken",result.id),localStorage.setItem("userid",result.customer_id),localStorage.setItem("authtokenexpire",result.valid_till),localStorage.setItem("login","P"),$.cookie("authtokenexpire",result.valid_till,{path:"/",expires:expiredate}),$.cookie("logan_session_id",result.logan_session_id,{path:"/",expires:expiredate}),getjioCart(),0!=localStorage.getItem("userid")&&null!=localStorage.getItem("userid")){var authtoken=localStorage.getItem("authtoken"),userid=localStorage.getItem("userid");if(authtoken&&userid){var def_addr_id=0,domain_url=$("#mstar_api_baseurl").val(),def_addr_api=domain_url+"entity/customer/get_details";$.ajax({url:def_addr_api,data:{},headers:{userid:userid,authtoken:authtoken},method:"GET",dataType:"JSON",success:function(resp){if("success"==resp.status){resp.result.your_details.preferred_shipping_address&&(def_addr_id=resp.result.your_details.preferred_shipping_address),resp.result.your_details.firstname&&localStorage.setItem("displayname",resp.result.your_details.firstname),resp.result.your_details.new_customer&&localStorage.setItem("new_customer",resp.result.your_details.new_customer),resp.result.your_details.email&&localStorage.setItem("displayemail",resp.result.your_details.email);var url=domain_url+"address/v2/get/all";$.ajax({url:url,data:{},headers:{userid:userid,authtoken:authtoken},method:"GET",dataType:"JSON",success:function(resp){if("success"==resp.status&&resp.result.address_list){var address_list=resp.result.address_list;if(address_list.length>0){var add_tmpl="",isActive=0;$(address_list).each((function(i,address){if(1==address.is_active){let addr_class="";if(def_addr_id==address.id){var popupPincode=localStorage.getItem("jio_popup_pincode");if((null==popupPincode||"yes"!=popupPincode)&&address.pin&&""!=address.pin){if($(".signin_btn").hide(),$(".pincode_availablity").hide(),localStorage.setItem("display_ship_name",address.addressee_name),localStorage.setItem("nms_mgo_pincode",address.pin),localStorage.setItem("nms_mgo_city",address.city),localStorage.getItem("display_ship_name")){let ship_name=localStorage.getItem("display_ship_name");ship_name.length>10&&(ship_name=ship_name.substring(0,10)+".."),document.getElementById("btn_deli_username").innerHTML=ship_name+",&nbsp;"}if(localStorage.getItem("nms_mgo_pincode")&&localStorage.getItem("nms_mgo_city")){let city_name=localStorage.getItem("nms_mgo_city");city_name.length>12&&(city_name=city_name.substring(0,12)+"..");let delivery_city_pin=city_name+" "+localStorage.getItem("nms_mgo_pincode");document.getElementById("delivery_city_pincode").textContent=delivery_city_pin}addr_class+=" active",$(".signin_btn").hide()}addr_class&&-1!==addr_class.indexOf("active")&&(localStorage.setItem("is_default_addr","yes"),localStorage.setItem("pincode_exist","yes")),localStorage.getItem("nms_mgo_pincode")&&address.pin&&localStorage.getItem("nms_mgo_pincode")==address.pin&&(localStorage.setItem("is_default_addr","yes"),localStorage.setItem("pincode_exist","yes"))}}}))}}},error:function(){}})}},error:function(error){sendToApp({type:"refreshAuthenticationToken"})}})}}}else sendToApp({type:"refreshAuthenticationToken"})},error:function(error){sendToApp({type:"refreshAuthenticationToken"})}})}function getjioCart(){var authtoken=localStorage.getItem("authtoken"),userid=localStorage.getItem("userid"),pincode=localStorage.getItem("nms_mgo_pincode");if(authtoken&&userid){var domain_url,url=$("#mst_api_cart_pin_baseurl").val()+"cart/get";$.ajax({url:url,data:{},headers:{userid:userid,authtoken:authtoken,pin:pincode},method:"GET",async:!1,dataType:"JSON",success:function(resp){if("success"==resp.status){var cart_data=resp.result,cart_count=0;cart_data.hasOwnProperty("cart")&&cart_data.cart.hasOwnProperty("lines")&&(cart_count=cart_data.cart.lines.length),localStorage.setItem("nms_cart_count",cart_count),cart_count&&cart_count>0?($(".minicart-wrapper .counter-number").text(cart_count).show(),myjio_updatecart(cart_count)):$(".minicart-wrapper .counter-number").text("").hide();var cart_info=JSON.stringify(cart_data);localStorage.setItem("cart_info",cart_info),applyPlusMinusButton()}},error:function(){}})}}function loginDetail(resp){if(resp){let result=resp.result.session,expiredate=new Date(result.valid_till.replace(/-/g,"/")),dateNow;expiredate>=new Date?(localStorage.setItem("authtoken",result.id),localStorage.setItem("userid",result.customer_id),localStorage.setItem("authtokenexpire",result.valid_till),localStorage.setItem("login","P"),$.cookie("authtokenexpire",result.valid_till,{path:"/",expires:expiredate}),$.cookie("logan_session_id",result.logan_session_id,{path:"/",expires:expiredate}),getjioCart()):ssoLoginDetail()}}function ssoLoginDetail(){sendToApp({type:"getAuthenticatonToken"});var loadcount=0;window.sendAuthToken=authtoken=>{1==++loadcount&&(authtoken?do_sso_login(authtoken):sendToApp({type:"refreshAuthenticationToken"}))}}$(document).on("click tap",".jio_orderHistory",(function(){handleDeepLink("jiomart_orders")})),$(document).on("click tap",".jio_profile",(function(){handleDeepLink("jiomart_profile")})),$(document).on("click tap",".jio_faqs",(function(){handleDeepLink("jiomart_help")})),$(document).on("click tap",".Closehome",(function(){handleDeepLink("jiomart_home")})),$(document).on("click tap","#main_category_top a, #hamburger_menu a",(function(e){if(null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite")){var version=localStorage.getItem("jio_app_version"),os=localStorage.getItem("jio_app_os"),is_old_version=!0;if(os&&version){os=os.toLowerCase();var app_ios_version=document.getElementById("myjio_ios_version").value,app_android_version=document.getElementById("myjio_android_version").value;"ios"==os&&compareAppVersion(app_ios_version,version)&&(is_old_version=!1),"android"==os&&compareAppVersion(app_android_version,version)&&(is_old_version=!1)}if(0==is_old_version){var link=$(this).attr("href"),dataHref=null!=$(this).attr("data-href")?$(this).attr("data-href"):"";(link.indexOf("all-category")>-1||"all-category"==dataHref)&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault(),$(this).hasClass("home_ripple")&&$(this).removeClass("home_ripple"),handleDeepLink("jiomart_category"),$(this).attr("href","javascript:void(0);"))}}})),$(document).on("click tap","#jioCart",(function(e){null!=localStorage.getItem("userid")&&0!=localStorage.getItem("userid")||null!=localStorage.getItem("authtoken")||(e.preventDefault(),localStorage.setItem("redirectUrl","/customer/sso/jio?target_url=/checkout/cart"),window.location.href=window.location.origin+"/customer/sso/jio?target_url=/checkout/cart")})),$("body").hasClass("myjiostore")&&localStorage.setItem("is_default_pin","no"),$(document).on("click tap","#go_back_dashboard",(function(e){homeBack()})),$(document).on("click tap",".myjiostore #headerback",(function(e){e.preventDefault();var url=window.location,fromDeeplink=!1,src_attr_arr=/deeplink=([^&]+)/.exec(url);if(src_attr_arr&&src_attr_arr[1]&&"1"==src_attr_arr[1]&&(fromDeeplink=!0),1==fromDeeplink||$("body").hasClass("cms-store-pickup")||$("body").hasClass("cms-home")||$("body").hasClass("new-all-cat")||$("body").hasClass("cms-faqs"))homeBack();else{var historyLenght;if(1==window.history.length)return homeBack(),!1;window.history.go(-1)}})),$(document).on("click tap",".myjiostore #type_one_search, .myjiostore #btn_mini_search",(function(){if(null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite")){var version=localStorage.getItem("jio_app_version"),os=localStorage.getItem("jio_app_os"),is_old_version=!0;if(os&&version){os=os.toLowerCase();var app_ios_version=document.getElementById("myjio_ios_version").value,app_android_version=document.getElementById("myjio_android_version").value;"ios"==os&&compareAppVersion(app_ios_version,version)&&(is_old_version=!1),"android"==os&&compareAppVersion(app_android_version,version)&&(is_old_version=!1)}0==is_old_version&&($("body").removeClass("disable-scroll"),$("#search_initial").remove(),handleDeepLink("jiomart_search"),myjio_app_header(2),myjio_hide_header())}})),$(window).on("load",(function(){null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite")&&null==localStorage.getItem("nms_mgo_pincode")&&localStorage.setItem("is_default_pin","no")})),$(document).ready((function(){var url=window.location,src_attr_arr=/source_attribution=([^&]+)/.exec(url);src_attr_arr&&(src_attr_arr[1]&&"MyJio-CPS"==src_attr_arr[1]&&($("#myjio_menu").show(),setJioCookie("smartprompt","disabled",1)),src_attr_arr[1]&&"JioMartApp-CPS"==src_attr_arr[1]&&setJioCookie("smartprompt","disabled",1)),$(document).on("click tap",".footer-container a, .cms-faqs .staticcontent a, .cms-contact-us .staticcontent a",(function(event){$("body").hasClass("myjiostore")&&event.preventDefault()})),null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite")&&localStorage.setItem("is_default_pin","no");var menu_cart_count=localStorage.getItem("nms_cart_count");menu_cart_count&&"0"!=menu_cart_count?$(".minicart-wrapper .counter-number").text(menu_cart_count).show():$(".minicart-wrapper .counter-number").text("").hide(),$(document).on("click tap",".myjiostore #btn_delivery",(function(){$("#rel_pincode_popup").modal("show")}));var jioaddress="";null!=localStorage.getItem("nms_refer_lite")&&null!=localStorage.getItem("nms_refer_lite")?("jiomartapp"==localStorage.getItem("nms_refer_lite")&&setJioCookie("smartprompt","disabled",1),"jio"==localStorage.getItem("nms_refer_lite")?(setJioCookie("smartprompt","disabled",1),$("#myjio_menu").show(),$(".catalog-category-view #sort-btn").css({bottom:"65px"}),$("body").hasClass("myjiostore")&&(getSessionDetails(),window.storedSessionDetails=storeddata=>{if(storeddata){var storedJson=JSON.parse(storeddata);storedJson.status&&"success"==storedJson.status&&storedJson.result.session?loginDetail(storedJson):ssoLoginDetail()}else ssoLoginDetail()}),loadingComplete(),$("body").hasClass("cms-home")?(sendToApp({type:"handleWebviewBack",value:!1}),window.handleBackKey=()=>{sendToApp({type:"close"})}):sendToApp({type:"handleWebviewBack",value:!0})):src_attr_arr&&myjioValidate(src_attr_arr)):src_attr_arr&&myjioValidate(src_attr_arr);var jioUrl,attr=new Url(window.location.href).query.source_attribution;if(attr&&"MyJio-CPS"==attr||null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite")){var version=localStorage.getItem("jio_app_version"),os=localStorage.getItem("jio_app_os"),is_old_version=!0;if(os&&version){os=os.toLowerCase();var app_ios_version=document.getElementById("myjio_ios_version").value,app_android_version=document.getElementById("myjio_android_version").value;"ios"==os&&compareAppVersion(app_ios_version,version)&&(is_old_version=!1),"android"==os&&compareAppVersion(app_android_version,version)&&(is_old_version=!1)}0==is_old_version?(myjio_search_endpoint(),$("#search_initial").remove(),$('.myjiostore #hamburger_menu a[href="/"]').addClass("Closehome"),$('.myjiostore #hamburger_menu a[href="/"]').attr("href","javascript:void(0);"),$('.myjiostore a[href*="all-category"]').attr("data-href","all-category"),$('.myjiostore a[href*="customer/orderhistory"]').addClass("jio_orderHistory"),$('.myjiostore a[href*="customer/orderhistory"]').attr("href","javascript:void(0);"),$('.myjiostore a[href*="customer/account"]').addClass("jio_profile"),$('.myjiostore a[href*="customer/account"]').attr("href","javascript:void(0);"),$('.myjiostore a[href*="faqs"]').addClass("jio_faqs"),$('.myjiostore a[href*="faqs"]').attr("href","javascript:void(0);")):document.querySelector(".header-main").style.display="flex",$("body").hasClass("cms-home")?(app_bottom_availablity("1"),app_floater_availablity("1")):(app_bottom_availablity("0"),app_floater_availablity("0")),window.cartModifiedOnNative=data=>{getjioCart()},$("#rel_pincode_popup").on("show.bs.modal",(function(e){app_floater_availablity("0")})),$("#rel_pincode_popup").on("hidden.bs.modal",(function(e){$("body").hasClass("cms-home")&&app_floater_availablity("1")}))}})),$(document).on("click tap",".external_link",(function(ev){var url,attr=new Url(window.location.href).query.source_attribution,link;(attr&&"MyJio-CPS"==attr||null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite"))&&(ev.preventDefault(),open_external_link($(this).attr("href")))})),$(document).on("click tap",".new-all-cat .category-list,.new-all-cat .category-list-main-item",(function(e){var url,attr=new Url(window.location.href).query.source_attribution;(attr&&"MyJio-CPS"==attr||null!=localStorage.getItem("nms_refer_lite")&&""!=localStorage.getItem("nms_refer_lite")&&"jio"==localStorage.getItem("nms_refer_lite"))&&("true"==$(this).attr("aria-expanded")?(myjioScrollPosition("1"),console.log("1")):(myjioScrollPosition("0"),console.log("0")))}));