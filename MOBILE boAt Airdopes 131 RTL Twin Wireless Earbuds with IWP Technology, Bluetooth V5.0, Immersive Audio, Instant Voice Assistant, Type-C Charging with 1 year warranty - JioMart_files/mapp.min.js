function app_dashboard(){app_sendToApp({type:"close"})}function app_back(){app_sendToApp({type:"handleWebviewBack",value:!0})}function app_loadingComplete(){app_sendToApp({type:"loadingCompleted"})}function app_update_cart(data){app_sendToApp({type:"updatedCartCount",value:{microAppID:"10001",itemsCount:parseInt(data)}})}function app_save_session_details(data){app_sendToApp({type:"saveSessionDetails",value:{microAppID:"10001",details:data}})}function app_send_email(to_email){app_sendToApp({type:"sendEmail",value:{subject:"",to:to_email,body:""}})}function app_make_call(mobile_number){app_sendToApp({type:"makeCall",value:mobile_number})}function app_open_external_link(link){app_sendToApp({type:"launchbrowser",value:link})}function app_update_back_url(title,url,history_flag=!1){"undefined"!=typeof navigationUpdate&&navigationUpdate(),1==window.isNewNavigation&&"1"==window.NavigationStatus?app_sendToApp({type:"updateNavigationDetails",value:{menuTitle:title,IsHistoryBackEnabled:history_flag,previousPageURL:url}}):app_sendToApp({type:"updateNavigationDetails",value:{menuTitle:title,previousPageURL:url}})}function app_header_title_status(){app_sendToApp({type:"headerTitleClickStatus",value:parseInt(1)})}function app_toast_msg(toast_message="",btn_text="",url_to_open="",messageType=""){""!=messageType?app_sendToApp({type:"showToast",value:{message:toast_message,ctaTitle:btn_text,ctaActionUrl:url_to_open,toastType:parseInt(messageType)}}):app_sendToApp({type:"showToast",value:{message:toast_message,ctaTitle:btn_text,ctaActionUrl:url_to_open}})}function app_search_endpoint(){var pincode=window.default_pin;localStorage.getItem("nms_mgo_pincode")&&(pincode=localStorage.getItem("nms_mgo_pincode"));var master_code=JSON.parse(localStorage.getItem("jio_region_codes")),region_filter="",cat_filter="",available_filter="",available_stores_arr=[];for(var vertical in master_code)if(master_code[vertical]){if("1"==window.autocomplete_inventory)for(let k in master_code[vertical]){var code;available_filter+="available_stores:"+master_code[vertical][k]+" OR "}available_stores_arr.push(vertical.toLowerCase())}available_stores_arr.push("master_vertical");let app_mstar_vertical_code=JSON.parse(localStorage.getItem("jio_vertical_city_code"));for(var vertical in app_mstar_vertical_code)if(aa_master_code[vertical]);else{var cat_name=vertical.toLowerCase();cat_name=cat_name.charAt(0).toUpperCase()+cat_name.slice(1),aa_cat_filter+="NOT category_level.level1:"+cat_name+" AND "}""!=cat_filter&&(region_filter+="("+(cat_filter=cat_filter.slice(0,-5))+")"),""!=cat_filter&&""!=available_filter&&(region_filter+=" AND "),""!=available_filter&&(region_filter+="("+(available_filter=available_filter.slice(0,-4))+")");var src=["JioMartApp"];src.push(localStorage.getItem("nms_mgo_pincode"));var master_code=window.default_vertical_city_code;for(var vertical in localStorage.getItem("jio_region_codes")&&(master_code=JSON.parse(localStorage.getItem("jio_region_codes"))),master_code)if(null!=master_code[vertical])for(let k in master_code[vertical])src.push(master_code[vertical][k]);console.log(region_filter),app_sendToApp({type:"saveDetailsForSearchEndpoint",value:{pincode:pincode,regionCode:master_code,productVerticals:available_stores_arr,endpointDetails:{hitsPerPage:10,clickAnalytics:!0,filters:region_filter,analyticsTags:src,plpFilters:get_app_recommended_filters()}}})}function get_app_recommended_filters(){let app_store_wise_filter="",app_available_filter="";var app_master_code=window.default_vertical_city_code;for(var vert in localStorage.getItem("jio_region_codes")&&(app_master_code=JSON.parse(localStorage.getItem("jio_region_codes"))),app_master_code)if(app_master_code[vert])for(let k in app_master_code[vert]){let reg_code=app_master_code[vert][k];app_store_wise_filter+="store_wise_mrp."+reg_code+".available:true OR ",app_available_filter+="available_stores:"+reg_code+" OR "}""!=app_store_wise_filter&&(app_store_wise_filter=app_store_wise_filter.slice(0,-4),app_available_filter=app_available_filter.slice(0,-4));var app_inventory_filter="inventory_stores:ALL OR ",app_inventory_code=JSON.parse(localStorage.getItem("jio_inventory_store_code"));for(var vert in app_inventory_code)if(app_inventory_code[vert])for(var code in app_inventory_code[vert]){var value;app_inventory_filter+="inventory_stores:"+app_inventory_code[vert][code]+" OR "}var app_region_filter="availability_status:A ";return""!=app_available_filter&&(app_region_filter+=" AND ("+app_available_filter+") AND ("+app_store_wise_filter+")"),""!=(app_inventory_filter=app_inventory_filter.slice(0,-3))&&(app_region_filter+=" AND ("+app_inventory_filter+")"),app_region_filter}function app_update_scroll_position(scroll_flag){app_sendToApp({type:"scrollPosition",value:scroll_flag})}function app_handleDeepLink(data){app_sendToApp({type:"handleDeeplink",value:data})}function app_share(data){app_sendToApp({type:"share",desc:data})}var lastScrollTop=0;function get_app_jio_cart(cart_retry,cartid){if(localStorage.getItem("nms_mgo_pincode"))var pincode=localStorage.getItem("nms_mgo_pincode");else var pincode=window.default_pin;var d,n=(new Date).getTime(),authtoken=localStorage.getItem("authtoken"),userid=localStorage.getItem("userid");if(authtoken&&userid){var domain_url=$("#mst_api_cart_pin_baseurl").val(),url=domain_url+"cart/get";"0"!=cartid&&null!=cartid&&(url=domain_url+"cart/get?cart_id="+cartid),$.ajax({url:url,data:{n:n},headers:{userid:userid,authtoken:authtoken,pin:pincode},method:"GET",dataType:"JSON",success:function(resp){if("success"==resp.status){var cart_data=resp.result,cart_count=0;if(cart_data.hasOwnProperty("cart")&&(cart_data.cart.hasOwnProperty("lines")&&(cart_count=cart_data.cart.lines.length),1==cart_retry)){let shippingaddr=cart_data.cart.shipping_address;localStorage.setItem("nms_mgo_pincode",shippingaddr.pin),localStorage.setItem("retry_cartid",cartid),$.cookie("nms_mgo_pincode",shippingaddr.pin,{expires:30}),window.location.href="/checkout/review"}localStorage.setItem("nms_cart_count",cart_count),cart_count&&cart_count>0&&app_update_cart(cart_count);var cart_info=JSON.stringify(cart_data);localStorage.setItem("cart_info",cart_info),applyPlusMinusButton()}},error:function(){}})}}function addressNativeOnload(pincode="",addressId=""){var nativeResponce=!1,authtoken=localStorage.getItem("authtoken"),userid=localStorage.getItem("userid");if(authtoken&&userid){var domain_url,url=$("#mstar_api_baseurl").val()+"address/v2/get/all";$.ajax({url:url,data:{},headers:{userid:userid,authtoken:authtoken},method:"GET",dataType:"JSON",async:!1,success:function(resp){if("success"==resp.status&&resp.result.address_list){var address_list=resp.result.address_list;address_list.length>0&&$(address_list).each((function(i,address){if(1==address.is_active)if(""!=addressId){if(addressId==address.id&&address.pin&&""!=address.pin&&0==nativeResponce){localStorage.setItem("nms_mgo_pincode",address.pin);var delivery_msg="<span>"+localStorage.getItem("nms_mgo_pincode")+"</span>";$("#delivery_details").html(delivery_msg),$.cookie("nms_mgo_pincode",address.pin,{expires:30,path:"/"}),localStorage.setItem("is_default_addr","yes"),localStorage.setItem("pincode_exist","yes"),nativeResponce=!0,setDefaultShippingAddress(address.pin,address.id,!0)}}else""!=pincode&&address.pin&&pincode==address.pin&&0==nativeResponce&&(localStorage.setItem("is_default_addr","yes"),localStorage.setItem("pincode_exist","yes"),$.cookie("nms_mgo_pincode",pincode,{expires:30,path:"/"}),setDefaultShippingAddress(pincode,address.id,!0),nativeResponce=!0)}))}},error:function(){}}),0==nativeResponce&&""!=pincode&&(localStorage.setItem("pincode_exist","no"),getCityDetails(pincode,!0,!0,!1,!0))}else""!=pincode&&getCityDetails(pincode,!0,!0,!1,!0)}function app_pincode_popup_api(){if(0!=localStorage.getItem("userid")&&null!=localStorage.getItem("userid")){var authtoken=localStorage.getItem("authtoken"),userid=localStorage.getItem("userid");if(authtoken&&userid){var def_addr_id=0,domain_url=$("#mstar_api_baseurl").val(),def_addr_api=domain_url+"entity/customer/get_details";$.ajax({url:def_addr_api,data:{},headers:{userid:userid,authtoken:authtoken},method:"GET",dataType:"JSON",async:!1,success:function(resp){if("success"==resp.status){resp.result.your_details.preferred_shipping_address&&(def_addr_id=resp.result.your_details.preferred_shipping_address);var url=domain_url+"address/v2/get/all";$.ajax({url:url,data:{},headers:{userid:userid,authtoken:authtoken},method:"GET",dataType:"JSON",async:!1,success:function(resp){if("success"==resp.status&&resp.result.address_list){var address_list=resp.result.address_list;if(address_list.length>0){var add_tmpl="",isActive=0;$(address_list).each((function(i,address){if(1==address.is_active){let addr_class="";if(def_addr_id==address.id){var popupPincode=localStorage.getItem("jio_popup_pincode");if((null==popupPincode||"yes"!=popupPincode)&&address.pin&&""!=address.pin){$(".signin_btn").hide(),$(".pincode_availablity").hide(),localStorage.setItem("nms_mgo_pincode",address.pin);var delivery_msg="<span>"+localStorage.getItem("nms_mgo_pincode")+"</span>";$("#delivery_details").html(delivery_msg),addr_class+=" active",$(".signin_btn").hide()}addr_class&&-1!==addr_class.indexOf("active")?(localStorage.setItem("is_default_addr","yes"),localStorage.setItem("pincode_exist","yes")):localStorage.setItem("pincode_exist","no"),localStorage.getItem("nms_mgo_pincode")&&address.pin&&(localStorage.getItem("nms_mgo_pincode")==address.pin?(localStorage.setItem("is_default_addr","yes"),localStorage.setItem("pincode_exist","yes")):localStorage.setItem("pincode_exist","no"))}}}))}}},error:function(){}})}}})}}}function update_app_url_history(){var url,attr=new Url(window.location.href).query.source_attribution;if((attr&&"JioMartApp-CPS"==attr||null!=localStorage.getItem("nms_refer_lite")&&null!=localStorage.getItem("nms_refer_lite")&&"jiomartapp"==localStorage.getItem("nms_refer_lite"))&&!($("body").hasClass("order-support-page")||$("body").hasClass("order-answer-page")||$("body").hasClass("ios-deletion"))){removeAccountHistory();var current_url=window.location.href,url_history=new Array;localStorage.getItem("app_url_history")&&(url_history=JSON.parse(localStorage.getItem("app_url_history")));var history_length=url_history.length;if(($("body").hasClass("otc-list-page")||$("body").hasClass("search-result-page"))&&""!=current_url)for(let index=history_length-1;index>=0;index--)if(""!=url_history[index]){var newUrl=url_history[index].indexOf("#")>-1?url_history[index].split("?")[0].split("#")[0]:url_history[index].split("?")[0],newCurrentUrl;if(console.log(newUrl),(current_url.indexOf("#")>-1?current_url.split("?")[0].split("#")[0]:current_url.split("?")[0])!=newUrl)break;url_history.splice(index,1)}var back_url="";if(history_length>0){let resultantObj={};resultantObj=appBackUrlHistory(url_history,current_url),resultantObj.back_url&&(back_url=resultantObj.back_url),resultantObj.url_history&&(url_history=resultantObj.url_history)}else{var body;back_url=document.getElementsByTagName("body")[0].classList.contains("otc-list-page")&&current_url.indexOf("?")>-1?current_url.split("?")[0]:current_url,url_history.push(back_url)}localStorage.setItem("app_url_history",JSON.stringify(url_history)),""!=back_url&&$("#headerback").attr("data-back",back_url);var back_title="",history_back=!1;1==window.isNewAppHeader&&($("body").hasClass("cms-faqs")||$("body").hasClass("need-support")||$("body").hasClass("cms-terms-and-conditions")||$("body").hasClass("new-all-cat")||$("body").hasClass("offers-index-page")||$("body").hasClass("offers-landing-page")||$("body").hasClass("cms-gift-store")||$("body").hasClass("cms-contact-us"))&&(back_title=null!=document.title&&null!=document.title&&""!=document.title?document.title:""),$("body").hasClass("otc-product-page")&&(history_back=!0),void 0!==app_update_back_url&&app_update_back_url(back_title,back_url,history_back)}}$(window).scroll((function(event){var url,attr=new Url(window.location.href).query.source_attribution;if(!$("body").hasClass("ios-deletion")&&(attr&&"JioMartApp-CPS"==attr||"jiomartapp"==$.cookie("nms_refer_lite")))if(localStorage.getItem("jio_store_id"));else{var popupStatus=!1;if($("body").hasClass("jm-modal-open")&&(popupStatus=!0),0==popupStatus){var st=$(this).scrollTop(),all_height;$(window).scrollTop()+window.innerHeight+100>=$(document).height()?app_update_scroll_position("0"):$(window).scrollTop()+window.innerHeight==$(document).height()?app_update_scroll_position("1"):app_update_scroll_position(st>lastScrollTop?"1":"0"),lastScrollTop=st}}})),$(document).ready((function(){var url,attr=new Url(window.location.href).query.source_attribution;if(attr&&"JioMartApp-CPS"==attr&&($.cookie("nms_refer_lite","jiomartapp",{expires:30}),localStorage.setItem("nms_refer_lite","jiomartapp")),localStorage.getItem("jio_app_os")){let os=localStorage.getItem("jio_app_os");$("body").addClass("jm-"+os.toLowerCase())}if(attr&&"JioMartApp-CPS"==attr||"jiomartapp"==$.cookie("nms_refer_lite")){if("jiomartapp"==localStorage.getItem("nms_refer_lite")&&(window.updateRetryCartId=data=>{if(data){let responce=JSON.parse(data);if(responce&&null!=responce.retryCartId){var retryPin=!1;if(null!=responce)if(responce.source&&responce.shipmentid){let retry_redirecturl="/customer/orderhistory/view/"+responce.channel+"/"+responce.orderid+"/"+responce.shipmentid+"/"+responce.source+"/"+responce.vertical;localStorage.setItem("retryredurl",retry_redirecturl),retryPin=!!responce.shipping_pin}else localStorage.setItem("retryredurl","/customer/orderhistory"),retryPin=!1;1==retryPin?(localStorage.setItem("retry_cartid",responce.retryCartId),localStorage.setItem("nms_mgo_pincode",responce.shipping_pin),$.cookie("nms_mgo_pincode",responce.shipping_pin,{expires:30}),window.location.href="/checkout/review"):get_app_jio_cart(!0,responce.retryCartId)}}}),"1"==window.adparams_status){var adparams_expiry=localStorage.getItem("jio_adparams_expiry"),adp_today=new Date,adp_expiry_date=new Date(adparams_expiry);adp_today.getTime()>adp_expiry_date.getTime()&&app_sendToApp({type:"adparams"})}1==window.isNewAppHeader&&($("body").hasClass("cms-faqs")||$("body").hasClass("need-support")||$("body").hasClass("cms-terms-and-conditions")||$("body").hasClass("new-all-cat")||$("body").hasClass("offers-index-page")||$("body").hasClass("offers-landing-page")||$("body").hasClass("cms-gift-store")||$("body").hasClass("cms-contact-us"))||app_header_title_status(),app_search_endpoint(),0==window.nativeoldVersion?($(".jiomartapp .header-sub").length>0&&$(".jiomartapp .header-sub").hide(),$("#rel_pincode_popup").length>0&&$(".jiomartapp #rel_pincode_popup").remove()):$(".header-sub").length>0&&$(".jiomartapp .header-sub").show(),void 0!==update_app_url_history&&update_app_url_history(),"yes"==localStorage.getItem("jiomartapp_logout")&&(Object.keys(localStorage).forEach((val,key)=>{"nms_mgo_pincode"!=val&&"nms_mgo_citycode"!=val&&"nms_mgo_city"!=val&&"redirectUrl"!=val&&localStorage.removeItem(val)}),$.each(document.cookie.split(/; */),(function(){var splitCookie,val=this.split("=")[0];"nms_refer_lite"!=val&&"nms_mgo_pincode"!=val&&"master_store_code"!=val&&"nms_mgo_city"!=val&&$.removeCookie(val,{path:"/"})})),localStorage.setItem("jiomartapp_logout","no")),null==localStorage.getItem("authtoken")&&(loadcount=0,window.sendAuthToken=response=>{if(loadcount++,response){var resp=JSON.parse(response);if("success"==resp.status&&resp.result.session){let result=resp.result.session,expiredate=new Date(result.valid_till);localStorage.setItem("authtoken",result.id),localStorage.setItem("userid",result.customer_id),localStorage.setItem("authtokenexpire",result.valid_till),localStorage.setItem("login","P"),app_save_session_details(response),get_app_jio_cart(!1,0),app_pincode_popup_api()}}},app_sendToApp({type:"getJMAuthenticatonToken"})),window.pincodeModifiedOnNative=responce=>{if(0==window.nativeoldVersion&&responce){var resp=JSON.parse(responce);if(resp.hasOwnProperty("pin")&&null!=resp.pin&&""!=resp.pin){localStorage.setItem("nms_mgo_pincode",resp.pin),$.cookie("nms_mgo_pincode",resp.pin,{expires:30,path:"/"});var delivery_msg="<span>"+localStorage.getItem("nms_mgo_pincode")+"</span>";$("#delivery_details").html(delivery_msg),addressNativeOnload(resp.pin,"")}}},window.addressModifiedOnNative=responce=>{if(0==window.nativeoldVersion&&responce){var resp=JSON.parse(responce);resp.hasOwnProperty("addressId")&&null!=resp.addressId&&""!=resp.addressId&&0!=localStorage.getItem("userid")&&null!=localStorage.getItem("userid")&&addressNativeOnload("",resp.addressId)}}}})),$(document).on("click tap",".email_link",(function(ev){var url,attr=new Url(window.location.href).query.source_attribution;(attr&&"JioMartApp-CPS"==attr||"jiomartapp"==$.cookie("nms_refer_lite"))&&(ev.preventDefault(),app_send_email("cs@jiomart.com"))})),$(document).on("click tap",".external_link",(function(ev){var url,attr=new Url(window.location.href).query.source_attribution,link;(attr&&"JioMartApp-CPS"==attr||"jiomartapp"==$.cookie("nms_refer_lite"))&&(ev.preventDefault(),app_open_external_link($(this).attr("href")))})),$(document).on("click tap",".all-cats-list .card-header",(function(e){var url,attr=new Url(window.location.href).query.source_attribution;(attr&&"JioMartApp-CPS"==attr||"jiomartapp"==$.cookie("nms_refer_lite"))&&0==$(this).closest(".child_accordion").length&&("true"==$(this).attr("aria-expanded")?app_update_scroll_position("1"):app_update_scroll_position("0"))}));